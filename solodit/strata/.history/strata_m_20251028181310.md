# strata

[What is Strata? | Strata](https://docs.strata.money/?q=yUSde)

https://github.com/solodit/solodit_content/blob/main/reports/Cyfrin/2025-06-11-cyfrin-strata-v2.1.md

https://github.com/Strata-Money/contracts

`maxWithdraw` 与`previewRedeem` 的区别

`previewWithdraw`  与`convertToShares` 的区别

 1.  state `withdraw` 时，从本金 `depositedBase` 状态变量上减去了 本金+yield，多次这样操作后，`depositedBase → 0`，pUSDe share 几乎兑换不到 USDe

attack：先向 USDe 金库捐赠足够多 USDe（会被视为 yield ），然后使得自己`withdraw`时的`previewYield` 等于`depositedBase` ，这样一次性使 totalAssets 为 0，之后用户无法赎回

1. ex-4626 某个 vault 被暂停或受限（`maxWithdraw` 很小），但 `previewRedeem` 仍然返回较大值 。
    
    应该使用 maxWithdraw 而不是 previewRedeem/previewWithdraw 来判断“可用基础资产”
    
2. ex-4626 / round 使用 `previewWithdraw` 将上取整，导致协议了用户比他应得的略多的 sUSDe
`previewWithdraw` 返回必须销毁的 shares amount（向上取整），以确保用户一定能拿到请求的资产数额（与 `convertToShares()` 向下取整 刚好相反）
3. mac 进入 yield phase 后，移除其了它 vaults，但没有暂停 `addVault`函数，还可以添加回来